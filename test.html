<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Генерация HTML</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>

<body onload="readTextFile()">
    <div class="container mt-5">
        <h1>Генерация HTML из текстового файла</h1>
        <div id="main" class="mt-4">
            ...
        </div>
    </div>

    <script>
        function readTextFile() {
            var xhr = new XMLHttpRequest();
            xhr.open("GET", "https://interview-autotest.github.io/tests/ios.md");
            xhr.onload = function () {
                var el = document.getElementById('main');
                el.innerHTML = generateHTML(xhr.responseText);
            }
            xhr.send();
        }

        function generateHTML(input) {
            const lines = input.split('\n');
            let html = '<form action="result.html" id="questions" class="container mt-3">';
            let titleIndex = 1;
            let subTitleIndex = 1;
            let questionIndex = 0;

            for (let line of lines) {
                line = line.trim();
                if (line.startsWith('#')) {
                    let firstSpaceIndex = line.indexOf(' ');
                    if (firstSpaceIndex == 1) {
                        // Основной заголовок
                        const mainQuestion = line.substring(firstSpaceIndex);
                        html += `<div id="q${titleIndex}${subTitleIndex}" class="collapse show" data-bs-parent="#questions">\n`;
                        html += `<h2>${titleIndex}. ${mainQuestion}</h2>\n`;
                        titleIndex++;
                        subTitleIndex = 1;
                    } else {
                        // Подзаголовок
                        const subQuestion = line.substring(firstSpaceIndex);
                        html += `<h3>${titleIndex - 1}.${subTitleIndex}. ${subQuestion}</h3>\n`;
                        subTitleIndex++;
                    }
                    questionIndex = 0; // Сброс индекса ответов
                } else {
                    // Ответы
                    if (questionIndex == 0) {
                        html += `<div class="form-check">\n`;
                        html += `<input type="radio" class="form-check-input" id="radio${titleIndex}${subTitleIndex}0" name="t${titleIndex}${subTitleIndex}" value="0" checked="checked">\n`;
                        html += `<label class="form-check-label" for="radio${titleIndex}${subTitleIndex}0">0 — Не знаю</label>\n`;
                        html += `</div>\n`;
                    } else {
                        const answer = line.substring(4);
                        html += `<div class="form-check">\n`;
                        html += `<input type="radio" class="form-check-input" id="radio${titleIndex}${subTitleIndex}${questionIndex}" name="t${titleIndex}${subTitleIndex}" value="${questionIndex}">\n`;
                        html += `<label class="form-check-label" for="radio${titleIndex}${subTitleIndex}${questionIndex}">${questionIndex} — ${answer}</label>\n`;
                        html += `</div>\n`;
                    }
                    questionIndex++;
                }
            }

            // Добавление кнопок
            html += `<button type="submit" class="btn btn-primary mt-3" disabled>\n`;
            html += `<a class="btn" href="#">Назад</a></button>\n`;
            html += `<button type="submit" class="btn btn-primary mt-3">\n`;
            html += `<a class="btn" data-bs-toggle="collapse" href="#q${titleIndex}">Далее</a></button>\n`;
            html += `</div>\n`;
            html += `</form>\n`;

            return html;
        }
    </script>
</body>

</html>